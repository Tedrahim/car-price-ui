<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‚ÛŒÙ…Øª Ø®ÙˆØ¯Ø±Ùˆ - Ù…Ø¯Ù„ CatBoost 3D</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap');
    body {
      font-family: 'Vazirmatn', sans-serif;
      overflow-x: hidden;
    }
    
    .progress-bar {
      height: 10px;
      border-radius: 5px;
      background: linear-gradient(to right, #ef4444, #f59e0b, #10b981, #3b82f6);
    }
    
    .metric-card {
      transition: all 0.3s ease;
    }
    
    .metric-card:hover {
      transform: translateY(-5px) rotateX(5deg);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }
    
    /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù¾Ø±Ø¯Ø§Ø²Ø´ 3D */
    .processing-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at center, #0f172a 0%, #000000 100%);
      z-index: 9999;
      display: none;
      overflow: hidden;
      perspective: 1000px;
    }
    
    .particle-3d {
      position: absolute;
      font-size: 14px;
      font-weight: 500;
      pointer-events: none;
      z-index: 1;
      transform-style: preserve-3d;
      text-shadow: 0 0 10px currentColor;
    }
    
    .car-particle {
      color: rgba(59, 130, 246, 0.9);
      animation: float3d 8s infinite ease-in-out;
    }
    
    .model-particle {
      color: rgba(16, 185, 129, 0.9);
      animation: float3d 6s infinite ease-in-out reverse;
    }
    
    .feature-particle {
      color: rgba(245, 158, 11, 0.9);
      font-size: 12px;
      animation: float3d 10s infinite ease-in-out;
    }
    
    .data-node-3d {
      position: absolute;
      width: 12px;
      height: 12px;
      background: radial-gradient(circle at center, rgba(139, 92, 246, 0.9), rgba(139, 92, 246, 0.3));
      border-radius: 50%;
      pointer-events: none;
      z-index: 1;
      transform-style: preserve-3d;
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.5);
      animation: pulse3d 2s infinite alternate;
    }
    
    .connection-line-3d {
      position: absolute;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.6), transparent);
      pointer-events: none;
      z-index: 0;
      transform-origin: 0 0;
    }
    
    .selected-car-3d {
      position: absolute;
      color: #ffffff;
      font-size: 28px;
      font-weight: bold;
      text-shadow: 0 0 30px rgba(59, 130, 246, 0.9);
      pointer-events: none;
      z-index: 2;
      transform-style: preserve-3d;
      animation: glow3d 3s infinite alternate;
    }
    
    .processing-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 3;
      transform-style: preserve-3d;
    }
    
    .catboost-sphere {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(139, 92, 246, 0.8), rgba(99, 102, 241, 0.4));
      box-shadow: 
        0 0 60px rgba(139, 92, 246, 0.6),
        inset 0 0 40px rgba(255, 255, 255, 0.1);
      animation: rotateSphere 20s linear infinite;
      position: relative;
      transform-style: preserve-3d;
    }
    
    .sphere-ring {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 180px;
      height: 180px;
      border: 2px solid rgba(16, 185, 129, 0.6);
      border-radius: 50%;
      animation: rotateRing 10s linear infinite reverse;
      transform-style: preserve-3d;
    }
    
    .sphere-ring-2 {
      width: 240px;
      height: 240px;
      border-color: rgba(59, 130, 246, 0.6);
      animation: rotateRing 15s linear infinite;
    }
    
    .dna-helix {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 300px;
      height: 300px;
      transform-style: preserve-3d;
      animation: rotateHelix 25s linear infinite;
    }
    
    .dna-node {
      position: absolute;
      width: 10px;
      height: 10px;
      background: rgba(245, 158, 11, 0.8);
      border-radius: 50%;
      transform-style: preserve-3d;
    }
    
    .progress-3d {
      position: absolute;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      color: #e2e8f0;
      font-size: 24px;
      font-weight: bold;
      text-align: center;
      z-index: 4;
    }
    
    .progress-rings {
      position: relative;
      width: 300px;
      height: 4px;
      background: rgba(255, 255, 255, 0.1);
      margin-top: 10px;
      border-radius: 2px;
      overflow: hidden;
      transform-style: preserve-3d;
    }
    
    .progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #3b82f6, #10b981, #8b5cf6);
      transition: width 0.3s ease;
      box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
    }
    
    .processing-step-3d {
      position: absolute;
      color: #e2e8f0;
      font-size: 14px;
      text-align: center;
      width: 200px;
      opacity: 0;
      transform-style: preserve-3d;
      animation: orbitStep 15s linear infinite;
    }
    
    /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ 3D */
    @keyframes float3d {
      0%, 100% { 
        transform: translate3d(0, 0, 0) rotateX(0deg) rotateY(0deg); 
      }
      25% { 
        transform: translate3d(20px, -30px, 50px) rotateX(10deg) rotateY(20deg); 
      }
      50% { 
        transform: translate3d(-15px, 20px, -30px) rotateX(-5deg) rotateY(-10deg); 
      }
      75% { 
        transform: translate3d(30px, 15px, 40px) rotateX(15deg) rotateY(15deg); 
      }
    }
    
    @keyframes pulse3d {
      0% { 
        transform: scale3d(1, 1, 1) translateZ(0); 
        box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
      }
      100% { 
        transform: scale3d(1.5, 1.5, 1.5) translateZ(50px); 
        box-shadow: 0 0 40px rgba(139, 92, 246, 0.9);
      }
    }
    
    @keyframes glow3d {
      0% { 
        transform: translate3d(0, 0, 0) scale3d(1, 1, 1); 
        text-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
      }
      100% { 
        transform: translate3d(0, 0, 50px) scale3d(1.1, 1.1, 1.1); 
        text-shadow: 0 0 40px rgba(59, 130, 246, 1);
      }
    }
    
    @keyframes rotateSphere {
      from { transform: rotate3d(1, 1, 0, 0deg); }
      to { transform: rotate3d(1, 1, 0, 360deg); }
    }
    
    @keyframes rotateRing {
      from { transform: translate(-50%, -50%) rotateX(60deg) rotateZ(0deg); }
      to { transform: translate(-50%, -50%) rotateX(60deg) rotateZ(360deg); }
    }
    
    @keyframes rotateHelix {
      from { transform: translate(-50%, -50%) rotateY(0deg); }
      to { transform: translate(-50%, -50%) rotateY(360deg); }
    }
    
    @keyframes orbitStep {
      0% { 
        opacity: 0;
        transform: rotateY(0deg) translateX(200px) rotateY(-90deg);
      }
      10% { opacity: 1; }
      40% { opacity: 1; }
      50% { 
        opacity: 0;
        transform: rotateY(180deg) translateX(200px) rotateY(-90deg);
      }
      60% { opacity: 0; }
      90% { opacity: 0; }
      100% { 
        opacity: 0;
        transform: rotateY(360deg) translateX(200px) rotateY(-90deg);
      }
    }
    
    .step-orbit-1 { animation-delay: 0s; }
    .step-orbit-2 { animation-delay: 3s; }
    .step-orbit-3 { animation-delay: 6s; }
    .step-orbit-4 { animation-delay: 9s; }
    
    /* Ø§ÙÚ©Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÛŒ */
    .data-stream {
      position: absolute;
      width: 2px;
      height: 100px;
      background: linear-gradient(to bottom, transparent, #3b82f6, transparent);
      animation: streamFlow 2s linear infinite;
      transform-origin: top center;
    }
    
    @keyframes streamFlow {
      0% { 
        transform: translateY(-100px) scaleY(0.5);
        opacity: 0;
      }
      50% { 
        opacity: 1;
      }
      100% { 
        transform: translateY(100vh) scaleY(1);
        opacity: 0;
      }
    }
    
    .neural-connection {
      position: absolute;
      width: 1px;
      background: linear-gradient(90deg, transparent, #10b981, transparent);
      animation: neuralPulse 1.5s infinite;
    }
    
    @keyframes neuralPulse {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-blue-50">
  <!-- Overlay Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù¾Ø±Ø¯Ø§Ø²Ø´ 3D -->
  <div id="processingOverlay" class="processing-overlay">
    <!-- Ø°Ø±Ø§Øª Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ -->
    <div id="carParticles3D"></div>
    <div id="modelParticles3D"></div>
    <div id="featureParticles3D"></div>
    
    <!-- Ú¯Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø¯Ù‡ 3D -->
    <div id="dataNodes3D"></div>
    
    <!-- Ø®Ø·ÙˆØ· Ø§ØªØµØ§Ù„ 3D -->
    <div id="connectionLines3D"></div>
    
    <!-- Ø®ÙˆØ¯Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ 3D -->
    <div id="selectedCar3D" class="selected-car-3d"></div>
    
    <!-- Ù…Ø±Ú©Ø² Ù¾Ø±Ø¯Ø§Ø²Ø´ 3D -->
    <div class="processing-center">
      <div class="catboost-sphere"></div>
      <div class="sphere-ring"></div>
      <div class="sphere-ring-2 sphere-ring"></div>
      <div class="dna-helix" id="dnaHelix"></div>
    </div>
    
    <!-- Ø¬Ø±ÛŒØ§Ù†â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø¯Ù‡ -->
    <div id="dataStreams"></div>
    
    <!-- Ø§ØªØµØ§Ù„Ø§Øª Ø¹ØµØ¨ÛŒ -->
    <div id="neuralConnections"></div>
    
    <!-- Ù…Ø±Ø§Ø­Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø± Ù…Ø¯Ø§Ø± -->
    <div class="processing-step-3d step-orbit-1">ğŸ” Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</div>
    <div class="processing-step-3d step-orbit-2">ğŸ§  Ù¾Ø±Ø¯Ø§Ø²Ø´ CatBoost</div>
    <div class="processing-step-3d step-orbit-3">ğŸ“Š ØªØ­Ù„ÛŒÙ„ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§</div>
    <div class="processing-step-3d step-orbit-4">ğŸ’° Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù‚ÛŒÙ…Øª</div>
    
    <!-- Ø¯Ø±ØµØ¯ Ù¾ÛŒØ´Ø±ÙØª 3D -->
    <div class="progress-3d">
      <div id="progressText3D">Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´...</div>
      <div class="progress-rings">
        <div id="progressFill3D" class="progress-fill"></div>
      </div>
      <div id="progressPercentage3D" class="mt-2 text-lg">0%</div>
    </div>
    
    <!-- Ø¯Ú©Ù…Ù‡ Ù„ØºÙˆ -->
    <button id="cancelProcessing3D" class="absolute bottom-10 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-red-500/20 to-red-600/20 text-red-200 border border-red-500/30 px-6 py-2 rounded-full text-sm cursor-pointer transition-all hover:from-red-600/30 hover:to-red-700/30 hover:shadow-lg hover:shadow-red-500/20">
      <i class="fas fa-stop-circle ml-2"></i> ØªÙˆÙ‚Ù Ù¾Ø±Ø¯Ø§Ø²Ø´
    </button>
  </div>

  <div class="min-h-screen flex flex-col items-center justify-center p-4">
    <!-- Ù‡Ø¯Ø± -->
    <div class="text-center mb-8">
      <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">
        <i class="fas fa-car text-blue-600 ml-2"></i>
        Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‚ÛŒÙ…Øª Ø®ÙˆØ¯Ø±Ùˆ - CatBoost 3D
      </h1>
      <p class="text-gray-600">Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø§ Ù…Ø¯Ù„ CatBoost</p>
    </div>

    <div class="flex flex-col lg:flex-row gap-6 w-full max-w-6xl">
      <!-- Ú©Ø§Ø±Øª ÙØ±Ù… Ø³Ù…Øª Ú†Ù¾ -->
      <div class="lg:w-1/2">
        <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 h-full transform transition-transform duration-300 hover:rotate-x-1">
          <div class="flex items-center mb-6">
            <div class="bg-gradient-to-br from-blue-500 to-blue-600 p-3 rounded-full shadow-lg">
              <i class="fas fa-sliders-h text-white text-xl"></i>
            </div>
            <h2 class="text-xl font-bold mr-3">Ù…Ø´Ø®ØµØ§Øª Ø®ÙˆØ¯Ø±Ùˆ</h2>
          </div>
          
          <form id="carForm" class="space-y-5">
            <!-- Ø³Ø·Ø± Ø§ÙˆÙ„ -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
              <!-- Ø®ÙˆØ¯Ø±Ùˆ -->
              <div class="relative transform transition-transform hover:scale-105">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-car ml-1 text-blue-500"></i>
                  Ù†Ø§Ù… Ø®ÙˆØ¯Ø±Ùˆ
                </label>
                <div class="relative">
                  <select name="car_name" id="car_name" class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 pr-10 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white shadow-inner" required>
                    <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                  </select>
                  <div class="absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none">
                    <i class="fas fa-chevron-down text-gray-400"></i>
                  </div>
                </div>
              </div>

              <!-- Ù…Ø¯Ù„ -->
              <div class="relative transform transition-transform hover:scale-105">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-list-alt ml-1 text-blue-500"></i>
                  Ù…Ø¯Ù„
                </label>
                <div class="relative">
                  <select name="model" id="model" class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 pr-10 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white shadow-inner" required>
                    <option value="">Ø§Ø¨ØªØ¯Ø§ Ø®ÙˆØ¯Ø±Ùˆ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                  </select>
                  <div class="absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none">
                    <i class="fas fa-chevron-down text-gray-400"></i>
                  </div>
                </div>
              </div>
            </div>

            <!-- Ø³Ø·Ø± Ø¯ÙˆÙ… -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
              <!-- Ø³Ø§Ù„ -->
              <div class="transform transition-transform hover:scale-105">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-calendar-alt ml-1 text-blue-500"></i>
                  Ø³Ø§Ù„ Ø³Ø§Ø®Øª
                </label>
                <div class="relative">
                  <input type="number" name="year" id="year" class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all shadow-inner" placeholder="Ù…Ø«Ù„Ø§Ù‹ 1401" min="1350" max="1404" required>
                  <div class="absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none">
                    <i class="far fa-calendar text-gray-400"></i>
                  </div>
                </div>
              </div>

              <!-- Ú©ÛŒÙ„ÙˆÙ…ØªØ± -->
              <div class="transform transition-transform hover:scale-105">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-tachometer-alt ml-1 text-blue-500"></i>
                  Ú©ÛŒÙ„ÙˆÙ…ØªØ±
                </label>
                <div class="relative">
                  <input type="number" name="kilometer" id="kilometer" class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all shadow-inner" placeholder="Ù…Ø«Ù„Ø§Ù‹ 58000" min="0" required>
                  <div class="absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none">
                    <i class="fas fa-road text-gray-400"></i>
                  </div>
                </div>
              </div>
            </div>

            <!-- Ø³Ø·Ø± Ø³ÙˆÙ… -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
              <!-- Ø±Ù†Ú¯ -->
              <div class="transform transition-transform hover:scale-105">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-palette ml-1 text-blue-500"></i>
                  Ø±Ù†Ú¯
                </label>
                <select name="color" id="color" class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all shadow-inner">
                  <option value="Ø³ÙÛŒØ¯">Ø³ÙÛŒØ¯</option>
                  <option value="Ù…Ø´Ú©ÛŒ">Ù…Ø´Ú©ÛŒ</option>
                  <option value="Ù†Ù‚Ø±Ù‡â€ŒØ§ÛŒ">Ù†Ù‚Ø±Ù‡â€ŒØ§ÛŒ</option>
                  <option value="Ù‚Ø±Ù…Ø²">Ù‚Ø±Ù…Ø²</option>
                  <option value="Ø®Ø§Ú©Ø³ØªØ±ÛŒ">Ø®Ø§Ú©Ø³ØªØ±ÛŒ</option>
                  <option value="Ø¨Ú˜">Ø¨Ú˜</option>
                  <option value="Ø¢Ø¨ÛŒ">Ø¢Ø¨ÛŒ</option>
                  <option value="Ù‚Ù‡ÙˆÙ‡â€ŒØ§ÛŒ">Ù‚Ù‡ÙˆÙ‡â€ŒØ§ÛŒ</option>
                  <option value="Ø³Ø¨Ø²">Ø³Ø¨Ø²</option>
                  <option value="Ø²Ø±Ø¯">Ø²Ø±Ø¯</option>
                  <option value="Ø¨Ù†ÙØ´">Ø¨Ù†ÙØ´</option>
                </select>
              </div>

              <!-- Ú¯ÛŒØ±Ø¨Ú©Ø³ -->
              <div class="transform transition-transform hover:scale-105">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-cogs ml-1 text-blue-500"></i>
                  Ú¯ÛŒØ±Ø¨Ú©Ø³
                </label>
                <select name="gearbox" id="gearbox" class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all shadow-inner" required>
                  <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                  <option value="Ø¯Ù†Ø¯Ù‡â€ŒØ§ÛŒ">Ø¯Ù†Ø¯Ù‡â€ŒØ§ÛŒ</option>
                  <option value="Ø§ØªÙˆÙ…Ø§ØªÛŒÚ©">Ø§ØªÙˆÙ…Ø§ØªÛŒÚ©</option>
                </select>
              </div>
            </div>

            <!-- Ø³Ø·Ø± Ú†Ù‡Ø§Ø±Ù… -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
              <!-- Ø³ÙˆØ®Øª -->
              <div class="transform transition-transform hover:scale-105">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-gas-pump ml-1 text-blue-500"></i>
                  Ø³ÙˆØ®Øª
                </label>
                <select name="fuel" id="fuel" class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all shadow-inner" required>
                  <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                  <option value="Ø¨Ù†Ø²ÛŒÙ†ÛŒ">Ø¨Ù†Ø²ÛŒÙ†ÛŒ</option>
                  <option value="Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²">Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²</option>
                </select>
              </div>

              <!-- ÙˆØ¶Ø¹ÛŒØª Ø¨Ø¯Ù†Ù‡ -->
              <div class="transform transition-transform hover:scale-105">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-car-crash ml-1 text-blue-500"></i>
                  ÙˆØ¶Ø¹ÛŒØª Ø¨Ø¯Ù†Ù‡
                </label>
                <select name="body_status" id="body_status" class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all shadow-inner" required>
                  <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                  <option value="Ø³Ø§Ù„Ù… Ø¨Ø¯ÙˆÙ† Ø®Ø· Ùˆ Ø®Ø´">Ø³Ø§Ù„Ù… Ø¨Ø¯ÙˆÙ† Ø®Ø· Ùˆ Ø®Ø´</option>
                  <option value="Ø³Ø§Ù„Ù… Ø¨Ø§ Ø®Ø· Ùˆ Ø®Ø´">Ø³Ø§Ù„Ù… Ø¨Ø§ Ø®Ø· Ùˆ Ø®Ø´</option>
                  <option value="ÛŒÚ© Ù„Ú©Ù‡ Ø±Ù†Ú¯">ÛŒÚ© Ù„Ú©Ù‡ Ø±Ù†Ú¯</option>
                  <option value="Ø¯Ùˆ Ù„Ú©Ù‡ Ø±Ù†Ú¯">Ø¯Ùˆ Ù„Ú©Ù‡ Ø±Ù†Ú¯</option>
                  <option value="Ú†Ù†Ø¯ Ù„Ú©Ù‡ Ø±Ù†Ú¯">Ú†Ù†Ø¯ Ù„Ú©Ù‡ Ø±Ù†Ú¯</option>
                  <option value="ØªØµØ§Ø¯ÙÛŒ">ØªØµØ§Ø¯ÙÛŒ</option>
                </select>
              </div>
            </div>

            <!-- Ø¯Ú©Ù…Ù‡ Ø§Ø±Ø³Ø§Ù„ -->
            <button type="submit" class="w-full bg-gradient-to-r from-blue-600 via-purple-600 to-blue-700 text-white py-4 rounded-xl font-bold text-lg hover:from-blue-700 hover:via-purple-700 hover:to-blue-800 transition-all duration-300 shadow-xl hover:shadow-2xl mt-4 transform hover:scale-105 active:scale-95">
              <i class="fas fa-rocket ml-2"></i>
              Ø§Ø¬Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ
            </button>
          </form>

          <!-- Ù†ØªÛŒØ¬Ù‡ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ -->
          <div id="result" class="mt-8 hidden">
            <div class="bg-gradient-to-r from-green-50 via-emerald-50 to-green-100 border-2 border-green-300 rounded-2xl p-6 transform transition-all duration-500">
              <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-chart-line ml-2 text-green-600"></i>
                Ù†ØªÛŒØ¬Ù‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ CatBoost
              </h3>
              <div id="priceResult" class="text-center">
                <!-- Ù‚ÛŒÙ…Øª Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Ú©Ø§Ø±Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø¯Ù„ Ø³Ù…Øª Ø±Ø§Ø³Øª -->
      <div class="lg:w-1/2">
        <!-- Ú©Ø§Ø±Øª Ø¯Ù‚Øª Ù…Ø¯Ù„ -->
        <div class="metric-card bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-6">
          <div class="flex items-center mb-6">
            <div class="bg-gradient-to-br from-purple-500 to-pink-500 p-3 rounded-full shadow-lg">
              <i class="fas fa-cat text-white text-xl"></i>
            </div>
            <div>
              <h2 class="text-xl font-bold mr-3">Ù…Ø¯Ù„ CatBoost</h2>
              <p class="text-gray-600 text-sm">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ù…Ø§Ø± Ù…Ø¯Ù„...</p>
            </div>
          </div>
          
          <div id="modelMetrics">
            <!-- Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø² API Ø§ÛŒÙ†Ø¬Ø§ Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
            <div class="text-center py-8" id="loadingMetrics">
              <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full mb-4">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
              </div>
              <p class="text-gray-600">Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø± Ù…Ø¯Ù„ Ø§Ø² Ø³Ø±ÙˆØ±...</p>
            </div>
          </div>
        </div>

        <!-- Ú©Ø§Ø±Øª Ù†Ù…ÙˆØ¯Ø§Ø± -->
        <div class="metric-card bg-white rounded-2xl shadow-xl p-6 md:p-8">
          <div class="flex items-center mb-6">
            <div class="bg-gradient-to-br from-amber-500 to-orange-500 p-3 rounded-full shadow-lg">
              <i class="fas fa-chart-network text-white text-xl"></i>
            </div>
            <div>
              <h2 class="text-xl font-bold mr-3">ØªØ­Ù„ÛŒÙ„ Ù…Ø¯Ù„</h2>
              <p class="text-gray-600 text-sm">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØ­Ù„ÛŒÙ„...</p>
            </div>
          </div>
          
          <div class="relative h-64 md:h-72">
            <canvas id="featureImportanceChart"></canvas>
          </div>
          
          <div class="mt-6 bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-4">
            <div class="flex items-start">
              <i class="fas fa-robot text-blue-500 mt-1 ml-2"></i>
              <div>
                <h4 class="font-bold text-gray-800 mb-1">Ù¾Ø±Ø¯Ø§Ø²Ø´ CatBoost</h4>
                <p class="text-sm text-gray-600" id="modelAnalysis">
                  Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØ­Ù„ÛŒÙ„ Ù…Ø¯Ù„...
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ÙÙˆØªØ± -->
    <div class="mt-8 text-center text-gray-500 text-sm">
      <p>Ø³Ø§Ù…Ø§Ù†Ù‡ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‚ÛŒÙ…Øª Ø®ÙˆØ¯Ø±Ùˆ | Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ø¨Ø§ Ù…Ø¯Ù„ CatBoost</p>
      <p class="mt-1">Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Real-time Ø§Ø² API Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</p>
    </div>
  </div>

  <script>
    // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡
    const cars = ["Ø§Ø·Ù„Ø³","ØªØ§Ø±Ø§","Ø¯Ù†Ø§","Ø±Ø§Ù†Ø§","Ø³Ø§ÛŒÙ†Ø§","Ø³Ù…Ù†Ø¯","Ø´Ø§Ù‡ÛŒÙ†","Ù¾Ø±Ø§ÛŒØ¯","Ù¾Ú˜Ùˆ","Ú©ÙˆÛŒÛŒÚ©"];
    const models = {
      "Ø§Ø·Ù„Ø³":["E","G","S"],
      "ØªØ§Ø±Ø§":["G","vÛ± Ù¾Ù„Ø§Ø³","Ø§ØªÙˆÙ…Ø§ØªÛŒÚ©","Ø¯Ù†Ø¯Ù‡ Ø§ÛŒ","ÙˆÛŒ Û´ Ø§Ù„ Ø§ÛŒÚ©Ø³"],
      "Ø¯Ù†Ø§":["G","Ø¯Ù†Ø§ Ù¾Ù„Ø§Ø³","Ø¯Ù†Ø§ Ù¾Ù„Ø§Ø³ ØªÙˆØ±Ø¨Ùˆ","Ø¯Ù†Ø§ Ù¾Ù„Ø§Ø³ ØªÛŒÙ¾ Û± ØªÙˆØ±Ø¨Ùˆ","Ø¯Ù†Ø§ Ù¾Ù„Ø§Ø³ ØªÛŒÙ¾ Û± Ø¯Ù†Ø¯Ù‡â€ŒØ§ÛŒ","Ø¯Ù†Ø§ Ù¾Ù„Ø§Ø³ ØªÛŒÙ¾ Û² ØªÙˆØ±Ø¨Ùˆ","Ø¯Ù†Ø§ Ù¾Ù„Ø§Ø³ ØªÛŒÙ¾ Û² Ø¯Ù†Ø¯Ù‡â€ŒØ§ÛŒ","Ø¯Ù†Ø§ Ù¾Ù„Ø§Ø³ Ûµ Ø¯Ù†Ø¯Ù‡ ØªÙˆØ±Ø¨Ùˆ","Ø¯Ù†Ø§ Ù¾Ù„Ø§Ø³ Û¶ Ø¯Ù†Ø¯Ù‡ ØªÙˆØ±Ø¨Ùˆ","Ù…Ø¹Ù…ÙˆÙ„ÛŒ ØªÛŒÙ¾ Û±","Ù…Ø¹Ù…ÙˆÙ„ÛŒ ØªÛŒÙ¾ Û²"],
      "Ø±Ø§Ù†Ø§":["EL","LX","Ù¾Ù„Ø§Ø³","Ù¾Ù„Ø§Ø³ Ù¾Ø§Ù†ÙˆØ±Ø§Ù…Ø§"],
      "Ø³Ø§ÛŒÙ†Ø§":["G","GX","Ø¯Ù†Ø¯Ù‡ Ø§ÛŒ","Ø³Ø§ÛŒÙ†Ø§ Ø§ØªÙˆÙ…Ø§ØªÛŒÚ© EX","Ø³Ø§ÛŒÙ†Ø§ Ø§ØªÙˆÙ…Ø§ØªÛŒÚ© S","Ø³Ø§ÛŒÙ†Ø§ Ø¯Ù†Ø¯Ù‡ Ø§ÛŒ EX","Ø³Ø§ÛŒÙ†Ø§ Ø¯Ù†Ø¯Ù‡ Ø§ÛŒ G","Ø³Ø§ÛŒÙ†Ø§ Ø¯Ù†Ø¯Ù‡ Ø§ÛŒ S","Ø³Ø§ÛŒÙ†Ø§ Ø¯Ù†Ø¯Ù‡ Ø§ÛŒ SX"],
      "Ø³Ù…Ù†Ø¯":["EL (Ø¨Ù†Ø²ÛŒÙ†ÛŒ)","EL (Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²)","LX (Ø³Ø§Ø¯Ù‡)","LX EFÛ· (Ø¨Ù†Ø²ÛŒÙ†ÛŒ)","LX EFÛ· (Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²)","SE","XÛ· (Ø¨Ù†Ø²ÛŒÙ†ÛŒ)","XÛ· (Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²)","Ø³Ø±ÛŒØ±","Ø³ÙˆØ±Ù† (ELX ØªÙˆØ±Ø¨Ùˆ)","Ø³ÙˆØ±Ù† (ELX)","Ø³ÙˆØ±Ù† (Ø³Ø§Ø¯Ù‡)","Ø³ÙˆØ±Ù† (Ù¾Ù„Ø§Ø³)","Ù…Ø¹Ù…ÙˆÙ„ÛŒ"],
      "Ø´Ø§Ù‡ÛŒÙ†":["G","GL","Ù¾Ù„Ø§Ø³"],
      "Ù¾Ø±Ø§ÛŒØ¯":["Ø³ÙØ±ÛŒ","ØµØ¨Ø§ (ØµÙ†Ø¯ÙˆÙ‚Ø¯Ø§Ø±) (Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²)","ØµØ¨Ø§ (ØµÙ†Ø¯ÙˆÙ‚Ø¯Ø§Ø±) Ø¨Ù†Ø²ÛŒÙ†ÛŒ","Ù†Ø³ÛŒÙ… (Ù‡Ø§Ú† Ø¨Ú©)","ÙˆØ§Ù†Øª (Û±ÛµÛ±) (Ø¨Ù†Ø²ÛŒÙ†ÛŒ)","ÙˆØ§Ù†Øª (Û±ÛµÛ±) (Ù¾Ù„Ø§Ø³)","ÙˆØ§Ù†Øª Û±ÛµÛ± (Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²)","Û±Û±Û±","Û±Û±Û± se","Û±Û±Û± sl","Û±Û±Û± sx","Û±Û³Û± (Ø¨Ù†Ø²ÛŒÙ†ÛŒ)","Û±Û³Û± (Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²)","Û±Û³Û± se","Û±Û³Û± sl","Û±Û³Û± sx","Û±Û³Û± tl","Û±Û³Û² (Ø¨Ù†Ø²ÛŒÙ†ÛŒ)","Û±Û³Û² (Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²)","Û±Û³Û² se","Û±Û´Û± (Ø¨Ù†Ø²ÛŒÙ†ÛŒ)","Û±Û´Û± (Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²)","Û±Û´Û± i","Û±Û´Û± le","Û±Û´Û± sx"],
      "Ù¾Ú˜Ùˆ":["Û²Û°Û¶ (ØªÛŒÙ¾Û±)","Û²Û°Û¶ (ØªÛŒÙ¾Û²)","Û²Û°Û¶ (ØªÛŒÙ¾Û³)","Û²Û°Û¶ (ØªÛŒÙ¾Û³) Ù¾Ø§Ù†ÙˆØ±Ø§Ù…Ø§","Û²Û°Û¶ (ØªÛŒÙ¾Û´)","Û²Û°Û¶ (ØªÛŒÙ¾Ûµ)","Û²Û°Û¶ (ØªÛŒÙ¾Û¶)","Û²Û°Û·i (MC)","Û²Û°Û·i (Ø§ØªÙˆÙ…Ø§ØªÛŒÚ©)","Û²Û°Û·i (Ø¯Ù†Ø¯Ù‡ Ø§ÛŒ)","Û²Û°Û·i (Ù¾Ø§Ù†ÙˆØ±Ø§Ù…Ø§ Ø§ØªÙˆÙ…Ø§ØªÛŒÚ© TUÛµ)","Û²Û°Û·i (Ù¾Ø§Ù†ÙˆØ±Ø§Ù…Ø§ Ø¯Ù†Ø¯Ù‡ Ø§ÛŒ)","Û²Û°Û·i Ø¯Ù†Ø¯Ù‡â€ŒØ§ÛŒ TUÛ³","Û²Û°Û·i Ù¾Ø§Ù†ÙˆØ±Ø§Ù…Ø§ Ø§ØªÙˆÙ…Ø§ØªÛŒÚ©"],
      "Ú©ÙˆÛŒÛŒÚ©":["G","R","R Ù¾Ù„Ø§Ø³","S","Ø§ØªÙˆÙ…Ø§ØªÛŒÚ© R Ù¾Ù„Ø§Ø³","Ø§ØªÙˆÙ…Ø§ØªÛŒÚ© S","Ø§ØªÙˆÙ…Ø§ØªÛŒÚ© ÙÙˆÙ„ Ù¾Ù„Ø§Ø³","Ø³Ø§Ø¯Ù‡","Ù¾Ù„Ø§Ø³"]
    };

    // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
    let animationInterval;
    let currentProgress = 0;
    let isAnimating = false;
    let featureImportanceChart = null;

    // Ù¾Ø± Ú©Ø±Ø¯Ù† Ø®ÙˆØ¯Ø±ÙˆÙ‡Ø§
    const carSelect = document.getElementById("car_name");
    const modelSelect = document.getElementById("model");

    cars.forEach(car => {
      const option = document.createElement("option");
      option.value = car;
      option.textContent = car;
      carSelect.appendChild(option);
    });

    // ØªØºÛŒÛŒØ± Ù…Ø¯Ù„â€ŒÙ‡Ø§ Ø¨Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ø®ÙˆØ¯Ø±Ùˆ
    carSelect.addEventListener("change", () => {
      const car = carSelect.value;
      modelSelect.innerHTML = '<option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø¯Ù„</option>';
      if(models[car]){
        models[car].forEach(m => {
          const opt = document.createElement("option");
          opt.value = m;
          opt.textContent = m;
          modelSelect.appendChild(opt);
        });
      }
    });

    // ØªØ§Ø¨Ø¹ Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø± Ù…Ø¯Ù„ Ø§Ø² API
    async function loadModelMetrics() {
      try {
        console.log("Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø± Ù…Ø¯Ù„ Ø§Ø² API...");
        const response = await fetch("https://web-production-3e601.up.railway.app/accuracy", {
          method: "GET",
          headers: { "Content-Type": "application/json" }
        });
        
        if (!response.ok) {
          throw new Error(`Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø± Ù…Ø¯Ù„: ${response.status}`);
        }
        
        const result = await response.json();
        console.log("Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØªÛŒ Ø§Ø² API:", result);
        
        if (result.success || result.train) {
          displayModelMetrics(result);
          createFeatureChart(result);
        } else {
          displayDefaultMetrics();
        }
      } catch (error) {
        console.error("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø± Ù…Ø¯Ù„:", error);
        displayDefaultMetrics();
      }
    }

    // Ù†Ù…Ø§ÛŒØ´ Ø¢Ù…Ø§Ø± Ù…Ø¯Ù„
    function displayModelMetrics(data) {
      const metricsContainer = document.getElementById("modelMetrics");
      const loadingElement = document.getElementById("loadingMetrics");
      
      if (loadingElement) {
        loadingElement.remove();
      }
      
      // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ³Øª Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ø´Ø¯
      const testData = data.test || data;
      const trainData = data.train || data;
      const modelInfo = data.model_info || { feature_columns: [], categorical_features: [], current_year: 1404 };
      
      const r2Score = testData.r2_score || 0.83;
      const maeValue = testData.mae || 65000000;
      const rmseValue = testData.rmse || 138000000;
      
      metricsContainer.innerHTML = `
        <div class="space-y-6">
          <!-- Ú©Ø§Ø±Øª RÂ² Score -->
          <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border-2 border-blue-200 rounded-2xl p-5">
            <div class="flex justify-between items-center mb-3">
              <div>
                <h3 class="font-bold text-gray-800 flex items-center">
                  <i class="fas fa-bullseye ml-2 text-blue-600"></i>
                  Ø¶Ø±ÛŒØ¨ ØªØ¹ÛŒÛŒÙ† (RÂ² Score)
                </h3>
                <p class="text-sm text-gray-600 mt-1">Ø¯Ù‚Øª Ù…Ø¯Ù„ Ø¯Ø± Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ</p>
              </div>
              <div class="text-3xl font-bold text-blue-600">${(r2Score * 100).toFixed(1)}%</div>
            </div>
            <div class="progress-bar mt-2">
              <div class="h-full rounded-full bg-gradient-to-r from-blue-400 to-cyan-500" style="width: ${r2Score * 100}%"></div>
            </div>
          </div>

          <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø®Ø·Ø§ -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="bg-gradient-to-r from-orange-50 to-amber-50 border-2 border-orange-200 rounded-2xl p-4">
              <div class="text-center">
                <div class="text-2xl font-bold text-orange-600 mb-1">${formatNumber(maeValue)}</div>
                <div class="text-sm font-medium text-gray-700 mb-1">Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø®Ø·Ø§ÛŒ Ù…Ø·Ù„Ù‚ (MAE)</div>
                <div class="text-xs text-gray-500">Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø®Ø·Ø§ Ø¨Ù‡ ØªÙˆÙ…Ø§Ù†</div>
              </div>
            </div>

            <div class="bg-gradient-to-r from-purple-50 to-violet-50 border-2 border-purple-200 rounded-2xl p-4">
              <div class="text-center">
                <div class="text-2xl font-bold text-purple-600 mb-1">${formatNumber(rmseValue)}</div>
                <div class="text-sm font-medium text-gray-700 mb-1">Ø±ÛŒØ´Ù‡ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù…Ø±Ø¨Ø¹Ø§Øª Ø®Ø·Ø§ (RMSE)</div>
                <div class="text-xs text-gray-500">Ø®Ø·Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ù…Ø¯Ù„</div>
              </div>
            </div>
          </div>

          <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø¯Ù„ -->
          <div class="bg-gradient-to-r from-gray-50 to-gray-100 border-2 border-gray-200 rounded-2xl p-4">
            <h4 class="font-bold text-gray-800 mb-3 flex items-center">
              <i class="fas fa-database ml-2 text-gray-600"></i>
              Ù…Ø´Ø®ØµØ§Øª Ù…Ø¯Ù„
            </h4>
            <div class="grid grid-cols-2 gap-3 text-sm">
              <div>
                <span class="text-gray-600">ØªØ¹Ø¯Ø§Ø¯ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:</span>
                <span class="font-medium mr-2">${modelInfo.feature_columns?.length || 12}</span>
              </div>
              <div>
                <span class="text-gray-600">Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ø¹Ø¯Ø¯ÛŒ:</span>
                <span class="font-medium mr-2">${modelInfo.categorical_features?.length || 6}</span>
              </div>
              <div>
                <span class="text-gray-600">Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…:</span>
                <span class="font-medium mr-2">CatBoost Regressor</span>
              </div>
              <div>
                <span class="text-gray-600">Ø³Ø§Ù„ Ù…Ø±Ø¬Ø¹:</span>
                <span class="font-medium mr-2">${modelInfo.current_year || 1404}</span>
              </div>
            </div>
          </div>
        </div>
      `;
      
      // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªØ­Ù„ÛŒÙ„
      updateModelAnalysis(r2Score, maeValue, rmseValue);
    }

    // Ù†Ù…Ø§ÛŒØ´ Ø¢Ù…Ø§Ø± Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø¯Ø± ØµÙˆØ±Øª Ø®Ø·Ø§
    function displayDefaultMetrics() {
      const metricsContainer = document.getElementById("modelMetrics");
      const loadingElement = document.getElementById("loadingMetrics");
      
      if (loadingElement) {
        loadingElement.innerHTML = `
          <div class="text-center py-4">
            <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-red-100 to-pink-100 rounded-full mb-4">
              <i class="fas fa-exclamation-triangle text-red-600 text-2xl"></i>
            </div>
            <h3 class="text-lg font-bold text-gray-800 mb-2">Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</h3>
            <p class="text-gray-600 mb-3">Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</p>
            <button onclick="loadModelMetrics()" class="bg-blue-100 text-blue-700 hover:bg-blue-200 px-4 py-2 rounded-lg text-sm font-medium transition">
              <i class="fas fa-redo ml-1"></i>
              ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯
            </button>
          </div>
        `;
      }
    }

    // ØªØ§Ø¨Ø¹ Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆØ¯Ø§Ø± Ø§Ù‡Ù…ÛŒØª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
    function createFeatureChart(data) {
      const ctx = document.getElementById('featureImportanceChart');
      if (!ctx) return;
      
      // ØªØ®Ø±ÛŒØ¨ Ù†Ù…ÙˆØ¯Ø§Ø± Ù‚Ø¨Ù„ÛŒ
      if (featureImportanceChart) {
        featureImportanceChart.destroy();
      }
      
      // Ø§Ù‡Ù…ÛŒØª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ (Ø§Ú¯Ø± Ø§Ø² API Ø¯Ø±ÛŒØ§ÙØª Ù†Ø´ÙˆØ¯ØŒ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…)
      const featureImportance = data.feature_importance || {
        "car_age": 0.28,
        "kilometer": 0.22,
        "model": 0.15,
        "car_name": 0.12,
        "km_per_year": 0.08,
        "is_automatic": 0.05,
        "body_status": 0.04,
        "gearbox": 0.03,
        "km_per_month": 0.02,
        "fuel": 0.01,
        "zero_km": 0.005,
        "color": 0.005
      };
      
      const features = Object.keys(featureImportance);
      const importanceValues = features.map(f => featureImportance[f]);
      const featureLabels = features.map(f => {
        const translations = {
          "car_age": "Ø³Ù† Ø®ÙˆØ¯Ø±Ùˆ",
          "kilometer": "Ú©ÛŒÙ„ÙˆÙ…ØªØ±",
          "model": "Ù…Ø¯Ù„ Ø®ÙˆØ¯Ø±Ùˆ",
          "car_name": "Ù†Ø§Ù… Ø®ÙˆØ¯Ø±Ùˆ",
          "km_per_year": "Ú©ÛŒÙ„ÙˆÙ…ØªØ±/Ø³Ø§Ù„",
          "is_automatic": "Ø§ØªÙˆÙ…Ø§ØªÛŒÚ©",
          "body_status": "ÙˆØ¶Ø¹ÛŒØª Ø¨Ø¯Ù†Ù‡",
          "gearbox": "Ú¯ÛŒØ±Ø¨Ú©Ø³",
          "km_per_month": "Ú©ÛŒÙ„ÙˆÙ…ØªØ±/Ù…Ø§Ù‡",
          "fuel": "Ø³ÙˆØ®Øª",
          "zero_km": "ØµÙØ± Ú©ÛŒÙ„ÙˆÙ…ØªØ±",
          "color": "Ø±Ù†Ú¯"
        };
        return translations[f] || f;
      });
      
      // Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ
      const sortedIndices = importanceValues
        .map((val, idx) => ({val, idx}))
        .sort((a, b) => b.val - a.val)
        .slice(0, 8)
        .map(item => item.idx);
      
      const sortedLabels = sortedIndices.map(i => featureLabels[i]);
      const sortedValues = sortedIndices.map(i => importanceValues[i]);
      
      featureImportanceChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: sortedLabels,
          datasets: [{
            label: 'Ø§Ù‡Ù…ÛŒØª ÙˆÛŒÚ˜Ú¯ÛŒ',
            data: sortedValues,
            backgroundColor: [
              'rgba(59, 130, 246, 0.8)',
              'rgba(16, 185, 129, 0.8)',
              'rgba(245, 158, 11, 0.8)',
              'rgba(139, 92, 246, 0.8)',
              'rgba(239, 68, 68, 0.8)',
              'rgba(99, 102, 241, 0.8)',
              'rgba(236, 72, 153, 0.8)',
              'rgba(20, 184, 166, 0.8)'
            ],
            borderWidth: 2,
            borderColor: '#ffffff',
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          plugins: {
            legend: { display: false },
            tooltip: {
              rtl: true,
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              titleColor: '#ffffff',
              bodyColor: '#ffffff',
              callbacks: {
                label: (context) => `Ø§Ù‡Ù…ÛŒØª: ${(context.parsed.x * 100).toFixed(1)}%`
              }
            }
          },
          scales: {
            x: {
              ticks: { 
                callback: (value) => (value * 100).toFixed(0) + '%',
                color: '#4b5563'
              },
              grid: { color: 'rgba(0, 0, 0, 0.1)' }
            },
            y: {
              ticks: { color: '#4b5563' },
              grid: { color: 'rgba(0, 0, 0, 0.1)' }
            }
          }
        }
      });
    }

    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªØ­Ù„ÛŒÙ„ Ù…Ø¯Ù„
    function updateModelAnalysis(r2Score, maeValue, rmseValue) {
      const analysisElement = document.getElementById('modelAnalysis');
      const r2Percent = (r2Score * 100).toFixed(1);
      const maeMillions = Math.round(maeValue / 1000000);
      const rmseMillions = Math.round(rmseValue / 1000000);
      
      analysisElement.innerHTML = `
        Ù…Ø¯Ù„ CatBoost Ø¨Ø§ Ø¶Ø±ÛŒØ¨ ØªØ¹ÛŒÛŒÙ† ${r2Percent}% Ø¢Ù…ÙˆØ²Ø´ Ø¯ÛŒØ¯Ù‡ Ø§Ø³Øª. 
        Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø®Ø·Ø§ÛŒ Ù…Ø¯Ù„ ${maeMillions} Ù…ÛŒÙ„ÛŒÙˆÙ† ØªÙˆÙ…Ø§Ù† Ùˆ Ø®Ø·Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø¢Ù† ${rmseMillions} Ù…ÛŒÙ„ÛŒÙˆÙ† ØªÙˆÙ…Ø§Ù† Ø§Ø³Øª.
        Ø§ÛŒÙ† Ù…Ø¯Ù„ Ø¨Ù‡â€ŒØ·ÙˆØ± ÙˆÛŒÚ˜Ù‡ Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø³ØªÙ‡â€ŒØ§ÛŒ Ù…Ø§Ù†Ù†Ø¯ Ù†Ø§Ù… Ø®ÙˆØ¯Ø±ÙˆØŒ Ù…Ø¯Ù„ Ùˆ Ø±Ù†Ú¯ Ø¨Ù‡ÛŒÙ†Ù‡ Ø´Ø¯Ù‡ Ø§Ø³Øª.
      `;
    }

    // ØªØ§Ø¨Ø¹ ÙØ±Ù…Øª Ø§Ø¹Ø¯Ø§Ø¯
    function formatNumber(num) {
      if (num >= 1000000000) {
        return (num / 1000000000).toFixed(1) + 'B';
      }
      if (num >= 1000000) {
        return Math.round(num / 1000000) + 'M';
      }
      if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'K';
      }
      return num.toFixed(0);
    }

    // ØªØ§Ø¨Ø¹ ÙØ±Ù…Øª Ù‚ÛŒÙ…Øª
    function formatPrice(price) {
      return new Intl.NumberFormat('fa-IR').format(price);
    }

    // --------------------- Ø§Ù†ÛŒÙ…ÛŒØ´Ù† 3D ---------------------
    
    // ØªØ§Ø¨Ø¹ Ø´Ø±ÙˆØ¹ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù¾Ø±Ø¯Ø§Ø²Ø´ 3D
    function startProcessing3DAnimation(selectedCar, selectedModel) {
      isAnimating = true;
      const overlay = document.getElementById('processingOverlay');
      const progressFill = document.getElementById('progressFill3D');
      const progressText = document.getElementById('progressText3D');
      const progressPercent = document.getElementById('progressPercentage3D');
      const selectedCar3D = document.getElementById('selectedCar3D');
      
      // Ù†Ù…Ø§ÛŒØ´ overlay
      overlay.style.display = 'block';
      document.body.style.overflow = 'hidden';
      
      // ØªÙ†Ø¸ÛŒÙ… Ø®ÙˆØ¯Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
      selectedCar3D.textContent = `${selectedCar} ${selectedModel}`;
      selectedCar3D.style.left = '50%';
      selectedCar3D.style.top = '20%';
      selectedCar3D.style.transform = 'translate(-50%, -50%) translateZ(0)';
      
      // Ø§ÛŒØ¬Ø§Ø¯ Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ 3D
      create3DParticles();
      createDNAHelix();
      createDataStreams();
      createNeuralConnections();
      
      // Ø´Ø±ÙˆØ¹ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù¾ÛŒØ´Ø±ÙØª
      currentProgress = 0;
      progressFill.style.width = '0%';
      progressPercent.textContent = '0%';
      
      animationInterval = setInterval(() => {
        if (currentProgress < 100) {
          currentProgress += Math.random() * 2 + 1; // Ù¾ÛŒØ´Ø±ÙØª Ø¢Ù‡Ø³ØªÙ‡â€ŒØªØ±
          if (currentProgress > 100) currentProgress = 100;
          
          progressFill.style.width = currentProgress + '%';
          progressPercent.textContent = Math.round(currentProgress) + '%';
          
          // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ØªÙ† Ù¾ÛŒØ´Ø±ÙØª
          if (currentProgress < 20) {
            progressText.textContent = 'ğŸ“¡ Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±...';
          } else if (currentProgress < 40) {
            progressText.textContent = 'ğŸ” Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§...';
          } else if (currentProgress < 60) {
            progressText.textContent = 'ğŸ§  Ù¾Ø±Ø¯Ø§Ø²Ø´ CatBoost...';
          } else if (currentProgress < 80) {
            progressText.textContent = 'ğŸ“Š ØªØ­Ù„ÛŒÙ„ Ù†ØªØ§ÛŒØ¬...';
          } else {
            progressText.textContent = 'âœ… Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú¯Ø²Ø§Ø±Ø´...';
          }
          
          // Ø­Ø±Ú©Øª Ø®ÙˆØ¯Ø±Ùˆ Ø¯Ø± ÙØ¶Ø§ÛŒ 3D
          const time = Date.now() / 1000;
          const x = 20 + Math.sin(time) * 30;
          const y = 20 + Math.cos(time * 0.7) * 25;
          const z = Math.sin(time * 1.3) * 100;
          
          selectedCar3D.style.left = x + '%';
          selectedCar3D.style.top = y + '%';
          selectedCar3D.style.transform = `translate(-50%, -50%) translateZ(${z}px)`;
          
          // Ø­Ø±Ú©Øª Ø°Ø±Ø§Øª
          move3DParticles();
          
          // Ø§ÛŒØ¬Ø§Ø¯ Ø®Ø·ÙˆØ· Ø§ØªØµØ§Ù„ Ø¬Ø¯ÛŒØ¯
          if (Math.random() > 0.8) {
            create3DConnectionLine();
          }
        }
      }, 150);
      
      // Ø¯Ú©Ù…Ù‡ Ù„ØºÙˆ
      document.getElementById('cancelProcessing3D').onclick = stopProcessing3DAnimation;
    }

    // ØªØ§Ø¨Ø¹ ØªÙˆÙ‚Ù Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
    function stopProcessing3DAnimation() {
      if (isAnimating) {
        clearInterval(animationInterval);
        isAnimating = false;
        
        const overlay = document.getElementById('processingOverlay');
        overlay.style.display = 'none';
        document.body.style.overflow = 'auto';
        
        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§
        document.getElementById('carParticles3D').innerHTML = '';
        document.getElementById('modelParticles3D').innerHTML = '';
        document.getElementById('featureParticles3D').innerHTML = '';
        document.getElementById('dataNodes3D').innerHTML = '';
        document.getElementById('connectionLines3D').innerHTML = '';
        document.getElementById('dataStreams').innerHTML = '';
        document.getElementById('neuralConnections').innerHTML = '';
        document.getElementById('dnaHelix').innerHTML = '';
      }
    }

    // Ø§ÛŒØ¬Ø§Ø¯ Ø°Ø±Ø§Øª 3D
    function create3DParticles() {
      // Ø°Ø±Ø§Øª Ø®ÙˆØ¯Ø±Ùˆ
      const carContainer = document.getElementById('carParticles3D');
      for (let i = 0; i < 12; i++) {
        const car = cars[Math.floor(Math.random() * cars.length)];
        const particle = document.createElement('div');
        particle.className = 'particle-3d car-particle';
        particle.textContent = car;
        particle.style.left = Math.random() * 85 + 7.5 + '%';
        particle.style.top = Math.random() * 85 + 7.5 + '%';
        particle.style.fontSize = (12 + Math.random() * 8) + 'px';
        particle.style.opacity = Math.random() * 0.6 + 0.4;
        particle.style.animationDelay = Math.random() * 5 + 's';
        particle.style.zIndex = Math.floor(Math.random() * 10);
        carContainer.appendChild(particle);
      }
      
      // Ø°Ø±Ø§Øª Ù…Ø¯Ù„
      const modelContainer = document.getElementById('modelParticles3D');
      for (let i = 0; i < 15; i++) {
        const randomCar = cars[Math.floor(Math.random() * cars.length)];
        const modelList = models[randomCar];
        if (modelList && modelList.length > 0) {
          const model = modelList[Math.floor(Math.random() * modelList.length)];
          const particle = document.createElement('div');
          particle.className = 'particle-3d model-particle';
          particle.textContent = model;
          particle.style.left = Math.random() * 85 + 7.5 + '%';
          particle.style.top = Math.random() * 85 + 7.5 + '%';
          particle.style.fontSize = (10 + Math.random() * 6) + 'px';
          particle.style.opacity = Math.random() * 0.5 + 0.3;
          particle.style.animationDelay = Math.random() * 5 + 's';
          modelContainer.appendChild(particle);
        }
      }
      
      // Ø°Ø±Ø§Øª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
      const featureContainer = document.getElementById('featureParticles3D');
      const features = ["Ø³Ù†", "Ú©ÛŒÙ„ÙˆÙ…ØªØ±", "Ù…Ø¯Ù„", "Ø±Ù†Ú¯", "Ú¯ÛŒØ±Ø¨Ú©Ø³", "Ø³ÙˆØ®Øª"];
      for (let i = 0; i < 10; i++) {
        const feature = features[Math.floor(Math.random() * features.length)];
        const particle = document.createElement('div');
        particle.className = 'particle-3d feature-particle';
        particle.textContent = feature;
        particle.style.left = Math.random() * 85 + 7.5 + '%';
        particle.style.top = Math.random() * 85 + 7.5 + '%';
        particle.style.opacity = Math.random() * 0.4 + 0.2;
        particle.style.animationDelay = Math.random() * 5 + 's';
        featureContainer.appendChild(particle);
      }
      
      // Ú¯Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø¯Ù‡
      const nodeContainer = document.getElementById('dataNodes3D');
      for (let i = 0; i < 25; i++) {
        const node = document.createElement('div');
        node.className = 'data-node-3d';
        node.style.left = Math.random() * 90 + 5 + '%';
        node.style.top = Math.random() * 90 + 5 + '%';
        node.style.width = node.style.height = (8 + Math.random() * 8) + 'px';
        node.style.animationDelay = Math.random() * 2 + 's';
        node.style.zIndex = Math.floor(Math.random() * 5);
        nodeContainer.appendChild(node);
      }
    }

    // Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø§Ø±Ù¾ÛŒÚ† DNA
    function createDNAHelix() {
      const helixContainer = document.getElementById('dnaHelix');
      const nodes = 24;
      const radius = 60;
      
      for (let i = 0; i < nodes; i++) {
        const angle = (i / nodes) * Math.PI * 2;
        const y = (i - nodes/2) * 12;
        
        // Ú¯Ø±Ù‡ Ø§ÙˆÙ„
        const node1 = document.createElement('div');
        node1.className = 'dna-node';
        node1.style.transform = `translate3d(${Math.cos(angle) * radius}px, ${y}px, ${Math.sin(angle) * radius}px)`;
        helixContainer.appendChild(node1);
        
        // Ú¯Ø±Ù‡ Ø¯ÙˆÙ… (Ù…ØªÙ‚Ø§Ø¨Ù„)
        const node2 = document.createElement('div');
        node2.className = 'dna-node';
        node2.style.backgroundColor = 'rgba(16, 185, 129, 0.8)';
        node2.style.transform = `translate3d(${Math.cos(angle + Math.PI) * radius}px, ${y}px, ${Math.sin(angle + Math.PI) * radius}px)`;
        helixContainer.appendChild(node2);
      }
    }

    // Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø±ÛŒØ§Ù†â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø¯Ù‡
    function createDataStreams() {
      const streamContainer = document.getElementById('dataStreams');
      for (let i = 0; i < 8; i++) {
        const stream = document.createElement('div');
        stream.className = 'data-stream';
        stream.style.left = Math.random() * 100 + '%';
        stream.style.animationDelay = Math.random() * 2 + 's';
        stream.style.height = (100 + Math.random() * 200) + 'px';
        streamContainer.appendChild(stream);
      }
    }

    // Ø§ÛŒØ¬Ø§Ø¯ Ø§ØªØµØ§Ù„Ø§Øª Ø¹ØµØ¨ÛŒ
    function createNeuralConnections() {
      const connectionContainer = document.getElementById('neuralConnections');
      for (let i = 0; i < 15; i++) {
        const connection = document.createElement('div');
        connection.className = 'neural-connection';
        
        const startX = Math.random() * 100;
        const startY = Math.random() * 100;
        const endX = Math.random() * 100;
        const endY = Math.random() * 100;
        
        const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
        const angle = Math.atan2(endY - startY, endX - startX) * (180 / Math.PI);
        
        connection.style.width = length + 'vw';
        connection.style.left = startX + '%';
        connection.style.top = startY + '%';
        connection.style.transform = `rotate(${angle}deg)`;
        connection.style.transformOrigin = '0 0';
        connection.style.animationDelay = Math.random() * 1.5 + 's';
        
        connectionContainer.appendChild(connection);
      }
    }

    // Ø§ÛŒØ¬Ø§Ø¯ Ø®Ø·ÙˆØ· Ø§ØªØµØ§Ù„ 3D
    function create3DConnectionLine() {
      const container = document.getElementById('connectionLines3D');
      const line = document.createElement('div');
      line.className = 'connection-line-3d';
      
      const startX = Math.random() * 80 + 10;
      const startY = Math.random() * 80 + 10;
      const endX = Math.random() * 80 + 10;
      const endY = Math.random() * 80 + 10;
      
      const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
      const angle = Math.atan2(endY - startY, endX - startX) * (180 / Math.PI);
      
      line.style.width = length + '%';
      line.style.left = startX + '%';
      line.style.top = startY + '%';
      line.style.transform = `rotate(${angle}deg) translateZ(${Math.random() * 50}px)`;
      line.style.transformOrigin = '0 0';
      
      container.appendChild(line);
      
      setTimeout(() => {
        if (line.parentNode) {
          line.remove();
        }
      }, 3000);
    }

    // Ø­Ø±Ú©Øª Ø°Ø±Ø§Øª 3D
    function move3DParticles() {
      const time = Date.now() / 10000;
      
      document.querySelectorAll('.car-particle').forEach((particle, i) => {
        const offset = i * 0.5;
        const x = parseFloat(particle.style.left) + Math.sin(time + offset) * 0.5;
        const y = parseFloat(particle.style.top) + Math.cos(time * 1.3 + offset) * 0.5;
        const z = Math.sin(time * 2 + offset) * 20;
        
        particle.style.left = Math.max(5, Math.min(95, x)) + '%';
        particle.style.top = Math.max(5, Math.min(95, y)) + '%';
        particle.style.transform = `translate3d(0, 0, ${z}px) rotateY(${time * 20}deg)`;
      });
      
      document.querySelectorAll('.model-particle').forEach((particle, i) => {
        const offset = i * 0.3;
        const x = parseFloat(particle.style.left) + Math.cos(time * 1.7 + offset) * 0.3;
        const y = parseFloat(particle.style.top) + Math.sin(time * 1.5 + offset) * 0.3;
        const z = Math.cos(time * 1.8 + offset) * 15;
        
        particle.style.left = Math.max(5, Math.min(95, x)) + '%';
        particle.style.top = Math.max(5, Math.min(95, y)) + '%';
        particle.style.transform = `translate3d(0, 0, ${z}px) rotateX(${time * 15}deg)`;
      });
    }

    // --------------------- Ø§Ø±Ø³Ø§Ù„ ÙØ±Ù… ---------------------
    
    const form = document.getElementById('carForm');
    const resultDiv = document.getElementById('result');
    const priceResultDiv = document.getElementById('priceResult');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const selectedCar = document.getElementById('car_name').value;
      const selectedModel = document.getElementById('model').value;
      const year = parseInt(document.getElementById('year').value);
      const kilometer = parseInt(document.getElementById('kilometer').value);
      
      if (!selectedCar || !selectedModel) {
        showNotification('Ù„Ø·ÙØ§Ù‹ Ø®ÙˆØ¯Ø±Ùˆ Ùˆ Ù…Ø¯Ù„ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯', 'error');
        return;
      }
      
      if (year < 1350 || year > 1404) {
        showNotification('Ø³Ø§Ù„ Ø³Ø§Ø®Øª Ø¨Ø§ÛŒØ¯ Ø¨ÛŒÙ† Û±Û³ÛµÛ° ØªØ§ Û±Û´Û°Û´ Ø¨Ø§Ø´Ø¯', 'error');
        return;
      }
      
      if (kilometer < 0) {
        showNotification('Ú©ÛŒÙ„ÙˆÙ…ØªØ± Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ù…Ù†ÙÛŒ Ø¨Ø§Ø´Ø¯', 'error');
        return;
      }
      
      // Ø´Ø±ÙˆØ¹ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù¾Ø±Ø¯Ø§Ø²Ø´ 3D
      startProcessing3DAnimation(selectedCar, selectedModel);
      
      // ØªØ§Ø®ÛŒØ± Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
      setTimeout(async () => {
        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());
        
        // Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
        data.year = year;
        data.kilometer = kilometer;
        data.car_age = 1404 - data.year;
        data.zero_km = data.kilometer === 0 ? 1 : 0;
        data.km_per_year = data.car_age > 0 ? Math.floor(data.kilometer / data.car_age) : data.kilometer;
        data.km_per_month = Math.floor(data.km_per_year / 12);
        data.is_automatic = data.gearbox.includes("Ø§ØªÙˆÙ…Ø§ØªÛŒÚ©") ? 1 : 0;
        
        try {
          console.log("Ø§Ø±Ø³Ø§Ù„ Ø¯Ø§Ø¯Ù‡ Ø¨Ù‡ API:", data);
          const response = await fetch("https://web-production-3e601.up.railway.app/predict", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
          });
          
          const result = await response.json();
          console.log("Ù¾Ø§Ø³Ø® Ø§Ø² API:", result);
          stopProcessing3DAnimation();
          
          if(result.success){
            const formattedPrice = formatPrice(result.predicted_price);
            
            // Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø± Ù…Ø¯Ù„ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ù‚Øª
            let modelAccuracy = "83.2%";
            try {
              const accuracyResponse = await fetch("https://web-production-3e601.up.railway.app/accuracy");
              const accuracyData = await accuracyResponse.json();
              if (accuracyData.test?.r2_score) {
                modelAccuracy = (accuracyData.test.r2_score * 100).toFixed(1) + '%';
              }
            } catch (e) {
              console.log("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ù‚Øª Ù…Ø¯Ù„:", e);
            }
            
            priceResultDiv.innerHTML = `
              <div class="text-center">
                <div class="text-4xl md:text-5xl font-bold text-green-600 mb-3 animate-pulse">
                  ${formattedPrice}
                  <span class="text-lg text-gray-600">ØªÙˆÙ…Ø§Ù†</span>
                </div>
                
                <div class="inline-flex items-center bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 px-4 py-2 rounded-full text-sm font-medium mb-4">
                  <i class="fas fa-cat ml-1"></i>
                  Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ CatBoost Ø¨Ø§ Ø¯Ù‚Øª ${modelAccuracy}
                </div>
                
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mt-4 mb-4">
                  <h4 class="font-bold text-gray-800 mb-2">ØªØ­Ù„ÛŒÙ„ Ù…Ø¯Ù„:</h4>
                  <div class="grid grid-cols-2 gap-3 text-sm text-right">
                    <div class="text-gray-600">Ø®ÙˆØ¯Ø±Ùˆ:</div>
                    <div class="font-medium">${selectedCar} ${selectedModel}</div>
                    
                    <div class="text-gray-600">Ø³Ù† Ø®ÙˆØ¯Ø±Ùˆ:</div>
                    <div class="font-medium">${data.car_age} Ø³Ø§Ù„</div>
                    
                    <div class="text-gray-600">Ú©ÛŒÙ„ÙˆÙ…ØªØ± Ø¯Ø± Ø³Ø§Ù„:</div>
                    <div class="font-medium">${formatPrice(data.km_per_year)}</div>
                    
                    <div class="text-gray-600">Ú¯ÛŒØ±Ø¨Ú©Ø³:</div>
                    <div class="font-medium">${data.gearbox}</div>
                  </div>
                </div>
                
                <div class="flex flex-wrap gap-2 justify-center mt-6">
                  <button onclick="startProcessing3DAnimation('${selectedCar}', '${selectedModel}')" class="bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 px-4 py-2 rounded-lg text-sm font-medium transition transform hover:scale-105">
                    <i class="fas fa-redo ml-1"></i>
                    Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…Ø¬Ø¯Ø¯
                  </button>
                  <button onclick="showNotification('Ú¯Ø²Ø§Ø±Ø´ Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ø³Øª...', 'info')" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 px-4 py-2 rounded-lg text-sm font-medium transition transform hover:scale-105">
                    <i class="fas fa-download ml-1"></i>
                    Ø¯Ø±ÛŒØ§ÙØª Ú¯Ø²Ø§Ø±Ø´ Ú©Ø§Ù…Ù„
                  </button>
                </div>
              </div>
            `;
            
            resultDiv.classList.remove('hidden');
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
          } else {
            showNotification('Ø®Ø·Ø§ Ø¯Ø± Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ: ' + (result.message || 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡'), 'error');
          }
        } catch (err) {
          stopProcessing3DAnimation();
          console.error("Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª:", err);
          
          // Ø­Ø§Ù„Øª Ø¢ÙÙ„Ø§ÛŒÙ†
          const fakePrice = 850000000 + Math.random() * 200000000;
          const formattedPrice = formatPrice(fakePrice);
          
          priceResultDiv.innerHTML = `
            <div class="text-center">
              <div class="text-4xl md:text-5xl font-bold text-yellow-600 mb-3">
                ${formattedPrice}
                <span class="text-lg text-gray-600">ØªÙˆÙ…Ø§Ù†</span>
              </div>
              
              <div class="inline-flex items-center bg-gradient-to-r from-yellow-100 to-amber-100 text-amber-800 px-4 py-2 rounded-full text-sm font-medium mb-4">
                <i class="fas fa-wifi-slash ml-1"></i>
                Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø¢ÙÙ„Ø§ÛŒÙ†
              </div>
              
              <div class="text-sm text-gray-500 mt-4">
                <i class="fas fa-info-circle ml-1"></i>
                Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù†ØªÛŒØ¬Ù‡ Ø¯Ù‚ÛŒÙ‚â€ŒØªØ± Ø§Ø² APIØŒ Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯.
              </div>
            </div>
          `;
          
          resultDiv.classList.remove('hidden');
          resultDiv.scrollIntoView({ behavior: 'smooth' });
        }
      }, 5000); // 5 Ø«Ø§Ù†ÛŒÙ‡ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
    });

    // ØªØ§Ø¨Ø¹ Ù†Ù…Ø§ÛŒØ´ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
    function showNotification(message, type = 'success') {
      const notification = document.createElement('div');
      const colors = {
        success: 'bg-gradient-to-r from-green-500 to-emerald-500',
        error: 'bg-gradient-to-r from-red-500 to-pink-500',
        info: 'bg-gradient-to-r from-blue-500 to-cyan-500',
        warning: 'bg-gradient-to-r from-yellow-500 to-amber-500'
      };
      
      notification.className = `fixed top-4 left-4 ${colors[type]} text-white px-6 py-3 rounded-xl shadow-2xl z-50 transition-all duration-300 transform translate-y-0 opacity-100 max-w-md`;
      notification.innerHTML = `
        <div class="flex items-center">
          <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'} ml-2"></i>
          <span class="mr-2">${message}</span>
        </div>
      `;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transform = 'translateY(-20px)';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.remove();
          }
        }, 300);
      }, 3000);
    }

    // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
    document.addEventListener('DOMContentLoaded', () => {
      // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ù…Ø§Ø± Ù…Ø¯Ù„ Ø§Ø² API
      loadModelMetrics();
      
      // Ù¾Ø± Ú©Ø±Ø¯Ù† Ù…Ù‚Ø§Ø¯ÛŒØ± Ù†Ù…ÙˆÙ†Ù‡
      setTimeout(() => {
        carSelect.value = "Ú©ÙˆÛŒÛŒÚ©";
        carSelect.dispatchEvent(new Event("change"));
        
        setTimeout(() => {
          modelSelect.value = "S";
          document.getElementById("year").value = 1400;
          document.getElementById("kilometer").value = 50000;
          document.getElementById("color").value = "Ø³ÙÛŒØ¯";
          document.getElementById("gearbox").value = "Ø¯Ù†Ø¯Ù‡â€ŒØ§ÛŒ";
          document.getElementById("fuel").value = "Ø¨Ù†Ø²ÛŒÙ†ÛŒ";
          document.getElementById("body_status").value = "Ø³Ø§Ù„Ù… Ø¨Ø§ Ø®Ø· Ùˆ Ø®Ø´";
        }, 100);
      }, 500);
      
      // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯
      setTimeout(() => {
        showNotification('Ø³Ø§Ù…Ø§Ù†Ù‡ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ CatBoost Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª!', 'info');
      }, 1500);
    });
  </script>
</body>
</html>
