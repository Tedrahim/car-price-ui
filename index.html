<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‚ÛŒÙ…Øª Ø®ÙˆØ¯Ø±Ùˆ</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
  <div class="min-h-screen flex flex-col items-center justify-center p-4">
    <div class="bg-white shadow-lg rounded-xl p-6 w-full max-w-lg">
      <h1 class="text-2xl font-bold mb-6 text-center">Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‚ÛŒÙ…Øª Ø®ÙˆØ¯Ø±Ùˆ</h1>
      
      <form id="carForm" class="space-y-4">
        <div>
          <label class="block mb-1">Ù†Ø§Ù… Ø®ÙˆØ¯Ø±Ùˆ</label>
          <input type="text" name="car_name" class="w-full border rounded px-3 py-2" placeholder="Ù…Ø«Ù„Ø§Ù‹ Ú©ÙˆÛŒÛŒÚ©" required>
        </div>

        <div>
          <label class="block mb-1">Ø³Ø§Ù„ Ø³Ø§Ø®Øª</label>
          <input type="number" name="year" class="w-full border rounded px-3 py-2" placeholder="Ù…Ø«Ù„Ø§Ù‹ 1401" required>
        </div>

        <div>
          <label class="block mb-1">Ú©ÛŒÙ„ÙˆÙ…ØªØ±</label>
          <input type="number" name="kilometer" class="w-full border rounded px-3 py-2" placeholder="Ù…Ø«Ù„Ø§Ù‹ 58000" required>
        </div>

        <div>
          <label class="block mb-1">Ø±Ù†Ú¯</label>
          <input type="text" name="color" class="w-full border rounded px-3 py-2" placeholder="Ù…Ø«Ù„Ø§Ù‹ Ø³ÙÛŒØ¯">
        </div>

        <div>
          <label class="block mb-1">Ú¯ÛŒØ±Ø¨Ú©Ø³</label>
          <select name="gearbox" class="w-full border rounded px-3 py-2" required>
            <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
            <option value="Ø¯Ù†Ø¯Ù‡â€ŒØ§ÛŒ">Ø¯Ù†Ø¯Ù‡â€ŒØ§ÛŒ</option>
            <option value="Ø§ØªÙˆÙ…Ø§ØªÛŒÚ©">Ø§ØªÙˆÙ…Ø§ØªÛŒÚ©</option>
          </select>
        </div>

        <div>
          <label class="block mb-1">Ø³ÙˆØ®Øª</label>
          <select name="fuel" class="w-full border rounded px-3 py-2" required>
            <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
            <option value="Ø¨Ù†Ø²ÛŒÙ†ÛŒ">Ø¨Ù†Ø²ÛŒÙ†ÛŒ</option>
            <option value="Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²">Ø¯ÙˆÚ¯Ø§Ù†Ù‡ Ø³ÙˆØ²</option>
          </select>
        </div>

        <div>
          <label class="block mb-1">ÙˆØ¶Ø¹ÛŒØª Ø¨Ø¯Ù†Ù‡</label>
          <select name="body_status" class="w-full border rounded px-3 py-2" required>
            <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
            <option value="Ø³Ø§Ù„Ù… Ø¨Ø¯ÙˆÙ† Ø®Ø· Ùˆ Ø®Ø´">Ø³Ø§Ù„Ù… Ø¨Ø¯ÙˆÙ† Ø®Ø· Ùˆ Ø®Ø´</option>
            <option value="Ø³Ø§Ù„Ù… Ø¨Ø§ Ø®Ø· Ùˆ Ø®Ø´">Ø³Ø§Ù„Ù… Ø¨Ø§ Ø®Ø· Ùˆ Ø®Ø´</option>
            <option value="ÛŒÚ© Ù„Ú©Ù‡ Ø±Ù†Ú¯">ÛŒÚ© Ù„Ú©Ù‡ Ø±Ù†Ú¯</option>
            <option value="Ø¯Ùˆ Ù„Ú©Ù‡ Ø±Ù†Ú¯">Ø¯Ùˆ Ù„Ú©Ù‡ Ø±Ù†Ú¯</option>
            <option value="Ú†Ù†Ø¯ Ù„Ú©Ù‡ Ø±Ù†Ú¯">Ú†Ù†Ø¯ Ù„Ú©Ù‡ Ø±Ù†Ú¯</option>
            <option value="ØªØµØ§Ø¯ÙÛŒ">ØªØµØ§Ø¯ÙÛŒ</option>
          </select>
        </div>

        <div>
          <label class="block mb-1">Ù…Ø¯Ù„</label>
          <input type="text" name="model" class="w-full border rounded px-3 py-2" placeholder="Ù…Ø«Ù„Ø§Ù‹ S" required>
        </div>

        <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition">Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‚ÛŒÙ…Øª</button>
      </form>

      <div id="result" class="mt-6 text-center text-lg font-semibold"></div>
    </div>
  </div>

  <script>
    const form = document.getElementById('carForm');
    const resultDiv = document.getElementById('result');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      resultDiv.textContent = "Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ...";
      
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      // Ø§ÙØ²ÙˆØ¯Ù† ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¹Ø¯Ø¯ÛŒ Ùˆ Ø¨ÙˆÙ„ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶
      data.zero_km = data.kilometer == 0 ? 1 : 0;
      data.km_per_year = Math.floor(data.kilometer / (1404 - data.year || 1));
      data.is_automatic = data.gearbox === "Ø§ØªÙˆÙ…Ø§ØªÛŒÚ©" ? 1 : 0;

      try {
        const response = await fetch("https://web-production-3e601.up.railway.app/predict", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const result = await response.json();
        if(result.success){
          resultDiv.textContent = `ğŸ’° Ù‚ÛŒÙ…Øª Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø´Ø¯Ù‡: ${result.formatted_price} ØªÙˆÙ…Ø§Ù†`;
        } else {
          resultDiv.textContent = `âŒ Ø®Ø·Ø§: ${result.errors?.join(', ') || result.message}`;
        }
      } catch (err) {
        resultDiv.textContent = `âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±`;
        console.error(err);
      }
    });
  </script>
</body>
</html>
